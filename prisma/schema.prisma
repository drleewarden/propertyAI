generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            String          @id @default(cuid())
  name          String?
  email         String          @unique
  emailVerified DateTime?
  password      String?
  image         String?
  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @updatedAt
  accounts      Account[]
  sessions      Session[]
  bookings      bookings[]
  child_details child_details[]
  headcounts    headcounts[]
  location_data location_data[]
  meal_plans    meal_plans[]
  meals         meals[]
}

model Account {
  userId            String
  type              String
  provider          String
  providerAccountId String
  refresh_token     String?
  access_token      String?
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String?
  session_state     String?
  createdAt         DateTime @default(now())
  updatedAt         DateTime
  user              User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@id([provider, providerAccountId])
}

model Session {
  sessionToken String   @unique
  userId       String
  expires      DateTime
  createdAt    DateTime @default(now())
  updatedAt    DateTime
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model VerificationToken {
  identifier String
  token      String
  expires    DateTime

  @@id([identifier, token])
}

model bookings {
  id            String         @id
  name          String
  date          DateTime
  time          String
  notes         String?
  userId        String
  childId       String?
  createdAt     DateTime       @default(now())
  updatedAt     DateTime
  child_details child_details? @relation(fields: [childId], references: [id])
  User          User           @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model child_details {
  id                 String               @id
  firstName          String
  lastName           String?
  dateOfBirth        DateTime
  gender             String?
  allergies          String?
  medicalInfo        String?
  notes              String?
  userId             String
  createdAt          DateTime             @default(now())
  updatedAt          DateTime
  bookedIn           Boolean              @default(false)
  signedIn           Boolean              @default(false)
  bookings           bookings[]
  User               User                 @relation(fields: [userId], references: [id], onDelete: Cascade)
  child_events       child_events[]
  child_meal_plans   child_meal_plans[]
  headcount_children headcount_children[]

  @@map("child-details")
}

model child_events {
  id            String        @id
  name          String
  eventType     String
  childId       String
  createdAt     DateTime      @default(now())
  updatedAt     DateTime
  child_details child_details @relation(fields: [childId], references: [id], onDelete: Cascade)

  @@map("child-events")
}

model child_meal_plans {
  id            String        @id
  childId       String
  mealPlanId    String
  preferences   String?
  createdAt     DateTime      @default(now())
  updatedAt     DateTime
  child_details child_details @relation(fields: [childId], references: [id], onDelete: Cascade)
  meal_plans    meal_plans    @relation(fields: [mealPlanId], references: [id], onDelete: Cascade)

  @@unique([childId, mealPlanId])
  @@map("child-meal-plans")
}

model headcount_children {
  id            String        @id
  headcountId   String
  childId       String
  createdAt     DateTime      @default(now())
  child_details child_details @relation(fields: [childId], references: [id], onDelete: Cascade)
  headcounts    headcounts    @relation(fields: [headcountId], references: [id], onDelete: Cascade)

  @@unique([headcountId, childId])
  @@map("headcount-children")
}

model headcounts {
  id                 String               @id
  userId             String
  date               DateTime             @default(now())
  notes              String?
  createdAt          DateTime             @default(now())
  updatedAt          DateTime
  headcount_children headcount_children[]
  User               User                 @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model location_data {
  id                   String   @id
  userId               String
  suburbName           String
  state                String
  medianHousePrice     Float
  medianUnitPrice      Float
  rentalPriceHouse     Float
  rentalPriceUnit      Float
  vacancyRate          Float
  notes                String?
  isFavorite           Boolean  @default(false)
  createdAt            DateTime @default(now())
  updatedAt            DateTime
  cityDistrict         String?
  demographicLifestyle String?
  schools              String?
  User                 User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, suburbName, state])
  @@map("location-data")
}

model meal_plan_entries {
  id         String     @id
  mealPlanId String
  mealId     String
  dayOfWeek  Int
  mealTime   String
  notes      String?
  createdAt  DateTime   @default(now())
  updatedAt  DateTime
  meals      meals      @relation(fields: [mealId], references: [id])
  meal_plans meal_plans @relation(fields: [mealPlanId], references: [id], onDelete: Cascade)

  @@unique([mealPlanId, dayOfWeek, mealTime])
  @@map("meal-plan-entries")
}

model meal_plans {
  id                String              @id
  userId            String
  name              String
  startDate         DateTime
  endDate           DateTime
  isActive          Boolean             @default(true)
  createdAt         DateTime            @default(now())
  updatedAt         DateTime
  child_meal_plans  child_meal_plans[]
  meal_plan_entries meal_plan_entries[]
  User              User                @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("meal-plans")
}

model meals {
  id                String              @id
  userId            String
  name              String
  description       String?
  ingredients       String?
  category          String
  isTemplate        Boolean             @default(false)
  allergyInfo       String?
  prepTime          Int?
  createdAt         DateTime            @default(now())
  updatedAt         DateTime
  meal_plan_entries meal_plan_entries[]
  User              User                @relation(fields: [userId], references: [id], onDelete: Cascade)
}
